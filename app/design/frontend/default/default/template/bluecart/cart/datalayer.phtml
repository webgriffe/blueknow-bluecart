<?php
/**
 * Template for Blueknow_Bluecart_Block_Cart_Datalayer.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Blueknow Bluecart
 * extension to newer versions in the future. If you wish to customize it for
 * your needs please save your changes before upgrading.
 *
 * @category	design
 * @copyright	Copyright (c) 2016  Blueknow, S.L. (http://www.blueknow.com)
 * @license		GNU General Public License
 * @author		<a href="mailto:josep.ventura@blueknow.com">Josep M Ventura</a>
 * @since		1.0.0
 *
 */
?>
<?php
    $bOrder = $this->getCart()->getOrder();
    $bProducts = $this->getCart()->getProducts();
?>

<script type="text/javascript">
	window.blueCart = window.blueCart || {};
	window.blueCart.data = window.blueCart.data || {};
	window.blueCart.data.cart = {
		total:	'<?php echo $bOrder->getTotal() ?>',
		subtotal: '<?php echo $bOrder->getSubtotal() ?>',
		taxes:	'<?php echo $bOrder->getTaxes() ?>',
		shipping: '<?php echo $bOrder->getShipping() ?>',
		other_fees:	'<?php echo $bOrder->getOtherFees() ?>',
		products: [
    <?php foreach($bProducts as $bProduct) { ?>
        {
			id: '<?php echo $bProduct->getId() ?>',
			name:	'<?php echo $bProduct->getName() ?>',
        	sku:	'<?php echo $bProduct->getSku() ?>',
			url:	'<?php echo $bProduct->getUrl() ?>',
			image:	'<?php echo $bProduct->getImage() ?>',
			price:	'<?php echo $bProduct->getPrice() ?>',
        	original_price:	'<?php echo ($bProduct->getOriginalPrice() == $bProduct->getPrice()) ? " " : $bProduct->getOriginalPrice() ?>',
        	partial_price:	'<?php echo $bProduct->getPartialPrice() ?>',
        	quantity:	'<?php echo $bProduct->getQuantity() ?>',
        	type: '<?php echo $bProduct->getType() ?>',
        	options: <?php echo json_encode($bProduct->getOptions()) ?>
    	},
<?php } ?>]
	}
</script>